from collections import OrderedDict

def get_set51():
    r"""Hyperparameters for symmetry functions, as discussed in:
    Nongnuch Artrith and Jorg Behler. "High-dimensional neural network potentials for
    metal surfaces: A prototype study for copper." Physical Review B 85, no. 4 (2012):
    045439.
    """
    return OrderedDict([('g2',
                         [{'eta': 0.0035710676725828126, 'Rs': 0.0},
                          {'eta': 0.03571067672582813, 'Rs': 0.0},
                          {'eta': 0.07142135345165626, 'Rs': 0.0},
                          {'eta': 0.12498736854039845, 'Rs': 0.0},
                          {'eta': 0.21426406035496876, 'Rs': 0.0},
                          {'eta': 0.3571067672582813, 'Rs': 0.0},
                          {'eta': 0.7142135345165626, 'Rs': 0.0},
                          {'eta': 1.428427069033125, 'Rs': 0.0}]),
                        ('g4',
                         [{'zeta': 1, 'lambda': -1, 'eta': 0.00035710676725828126},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.00035710676725828126},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.00035710676725828126},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.00035710676725828126},
                          {'zeta': 1, 'lambda': -1, 'eta': 0.010713203017748437},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.010713203017748437},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.010713203017748437},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.010713203017748437},
                          {'zeta': 1, 'lambda': -1, 'eta': 0.0285685413806625},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.0285685413806625},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.0285685413806625},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.0285685413806625},
                          {'zeta': 1, 'lambda': -1, 'eta': 0.05356601508874219},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.05356601508874219},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 4, 'lambda': -1, 'eta': 0.05356601508874219},
                          {'zeta': 4, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 16, 'lambda': -1, 'eta': 0.05356601508874219},
                          {'zeta': 16, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 1, 'lambda': -1, 'eta': 0.08927669181457032},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.08927669181457032},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 4, 'lambda': -1, 'eta': 0.08927669181457032},
                          {'zeta': 4, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 16, 'lambda': -1, 'eta': 0.08927669181457032},
                          {'zeta': 16, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 1, 'lambda': -1, 'eta': 0.16069804526622655},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.16069804526622655},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.16069804526622655},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.16069804526622655},
                          {'zeta': 4, 'lambda': -1, 'eta': 0.16069804526622655},
                          {'zeta': 4, 'lambda': 1, 'eta': 0.16069804526622655},
                          {'zeta': 16, 'lambda': -1, 'eta': 0.16069804526622655},
                          {'zeta': 16, 'lambda': 1, 'eta': 0.16069804526622655},
                          {'zeta': 1, 'lambda': -1, 'eta': 0.28568541380662504},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.28568541380662504},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.28568541380662504},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.28568541380662504},
                          {'zeta': 4, 'lambda': -1, 'eta': 0.28568541380662504},
                          {'zeta': 4, 'lambda': 1, 'eta': 0.28568541380662504},
                          {'zeta': 16, 'lambda': 1, 'eta': 0.28568541380662504}])])


def get_set30():
    r"""Hyperparameters for symmetry functions, as discussed in:
    Artrith, N., Hiller, B. and Behler, J., 2013. Neural network potentials for metals and
    oxidesâ€“First applications to copper clusters at zinc oxide. physica status solidi (b),
    250(6), pp.1191-1203.
    """
    return OrderedDict([('g2',
                         [{'eta': 0.003213960905324531, 'Rs': 0.0},
                          {'eta': 0.03571067672582813, 'Rs': 0.0},
                          {'eta': 0.07142135345165626, 'Rs': 0.0},
                          {'eta': 0.12498736854039845, 'Rs': 0.0},
                          {'eta': 0.21426406035496876, 'Rs': 0.0},
                          {'eta': 0.3571067672582813, 'Rs': 0.0},
                          {'eta': 0.7142135345165626, 'Rs': 0.0},
                          {'eta': 1.428427069033125, 'Rs': 0.0}]),
                        ('g4',
                         [{'zeta': 1, 'lambda': -1, 'eta': 0.00035710676725828126},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.00035710676725828126},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.00035710676725828126},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.00035710676725828126},
                          {'zeta': 1, 'lambda': -1, 'eta': 0.010713203017748437},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.010713203017748437},
                          {'zeta': 2, 'lambda': -1, 'eta': 0.010713203017748437},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.010713203017748437},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.0285685413806625},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.0285685413806625},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 4, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 16, 'lambda': 1, 'eta': 0.05356601508874219},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 4, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 16, 'lambda': 1, 'eta': 0.08927669181457032},
                          {'zeta': 1, 'lambda': 1, 'eta': 0.16069804526622655},
                          {'zeta': 2, 'lambda': 1, 'eta': 0.16069804526622655},
                          {'zeta': 4, 'lambda': 1, 'eta': 0.16069804526622655},
                          {'zeta': 16, 'lambda': 1, 'eta': 0.16069804526622655}])])


def get_default_bispectrum():
    return OrderedDict({
            "jmax": 4,
            "rfac0": 0.99363,
            "diagonalstyle": 3,
            "rmin0": 0,
            "switch_flag": 1,
            "bzero_flag": 0,
            "use_shared_array": False,
            "weights": None
        })


def get_bs_size(twojmax, diagonal):
        """
        Return the size of descriptor.
        """
        N = 0
        for j1 in range(0, twojmax + 1):
            if diagonal == 2:
                N += 1
            elif diagonal == 1:
                for j in range(0, min(twojmax, 2 * j1) + 1, 2):
                    N += 1
            elif diagonal == 0:
                for j2 in range(0, j1 + 1):
                    for j in range(j1 - j2, min(twojmax, j1 + j2) + 1, 2):
                        N += 1
            elif diagonal == 3:
                for j2 in range(0, j1 + 1):
                    for j in range(j1 - j2, min(twojmax, j1 + j2) + 1, 2):
                        if j >= j1:
                            N += 1
        return N


def get_default_soap():
    return OrderedDict({
        "n_max": 4,
        "l_max": 4,
        "cutoff": 4.0,
        "radial_basis": "polynomial",
        "eta": 0.5
    })
